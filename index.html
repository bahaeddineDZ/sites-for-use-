<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ðŸ“š Ù…ÙƒØªØ¨ØªÙŠ - Ù†Ø³Ø®Ø© ÙƒØ§Ù…Ù„Ø© Ù…Ø¹ Ù…Ø´ØºÙ„ Ø§Ù„ØµÙˆØª ÙˆØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root {
  --primary: #2c3e50;
  --accent: #2980b9;
  --danger: #e74c3c;
  --muted: #7f8c8d;
}
body {
  font-family: Arial, sans-serif;
  background-color: var(--primary);
  color: white;
  margin: 0;
  padding: 0;
}
#audio-icon {
  width: 60px;
  height: 60px;
  background: var(--accent);
  position: fixed;
  bottom: 20px;
  right: 20px;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: grab;
  z-index: 999;
}
#audio-player {
  position: fixed;
  bottom: 100px;
  right: 20px;
  width: 300px;
  background: #34495e;
  padding: 10px;
  border-radius: 10px;
  display: none;
}
#audio-list {
  max-height: 200px;
  overflow-y: auto;
}
.audio-item {
  padding: 5px;
  cursor: pointer;
  border-bottom: 1px solid #555;
}
.audio-item:hover {
  background: #2980b9;
}
</style>
</head>
<body>

<div id="audio-icon">ðŸ”Š</div>
<div id="audio-player">
  <audio id="player" controls style="width: 100%;"></audio>
  <div id="audio-list"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
  // ====== Firebase Config ======
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const audioIcon = document.getElementById('audio-icon');
  const audioPlayerDiv = document.getElementById('audio-player');
  const player = document.getElementById('player');
  const audioListDiv = document.getElementById('audio-list');

  // ===== Load Icon Position =====
  db.collection('ui').doc('audioIcon').get().then(doc => {
    if(doc.exists){
      const pos = doc.data();
      audioIcon.style.right = pos.right + 'px';
      audioIcon.style.bottom = pos.bottom + 'px';
    }
  });

  // ===== Drag & Drop for Icon =====
  let isDragging = false;
  let offsetX, offsetY;

  audioIcon.addEventListener('mousedown', (e)=>{
    isDragging = true;
    offsetX = e.clientX - audioIcon.getBoundingClientRect().right;
    offsetY = e.clientY - audioIcon.getBoundingClientRect().bottom;
    audioIcon.style.cursor = 'grabbing';
  });
  document.addEventListener('mouseup', ()=>{
    if(isDragging){
      isDragging = false;
      audioIcon.style.cursor = 'grab';
      // Save position to Firestore
      db.collection('ui').doc('audioIcon').set({
        right: parseInt(audioIcon.style.right),
        bottom: parseInt(audioIcon.style.bottom)
      });
    }
  });
  document.addEventListener('mousemove', (e)=>{
    if(isDragging){
      let right = window.innerWidth - e.clientX - offsetX - audioIcon.offsetWidth;
      let bottom = window.innerHeight - e.clientY - offsetY - audioIcon.offsetHeight;
      audioIcon.style.right = right + 'px';
      audioIcon.style.bottom = bottom + 'px';
    }
  });

  // ===== Toggle Player =====
  audioIcon.addEventListener('click', ()=>{
    audioPlayerDiv.style.display = audioPlayerDiv.style.display === 'none' ? 'block' : 'none';
  });

  // ===== Load Audio List from Firestore =====
  db.collection('audio').get().then(snapshot => {
    snapshot.forEach(doc => {
      const data = doc.data();
      const div = document.createElement('div');
      div.classList.add('audio-item');
      div.textContent = data.name;
      div.addEventListener('click', ()=>{
        player.src = data.url;
        player.play();
      });
      audioListDiv.appendChild(div);
    });
  });
</script>
</body>
</html>
